"use strict";L.TileLayer.Canvas=L.TileLayer.extend({_delays:{},_delaysForZoom:null,createCanvas:function(e,t,a){var i,o=e.getContext("2d"),s=this.options.doubleSize,r=this.getTileSize(),n=r.x,l=r.y;e.width=s?2*n:n,e.height=s?2*l:l;var c=new Image;c.onload=function(){try{o.drawImage(c,0,0),e.complete=!0}catch(e){i=e}finally{a(i,e)}},c.onerror=this._tileOnError.bind(this,a,c);var h=this._getZoomForUrl();c.src=isNaN(h)?"":this.getTileUrl(t),c.crossOrigin="anonymous"},createTile:function(e,t){var a=this,i=this.options.timeout,o=e.z,s=document.createElement("canvas");return i?(o!==this._delaysForZoom&&(this._clearDelaysForZoom(),this._delaysForZoom=o),this._delays[o]||(this._delays[o]=[]),this._delays[o].push(setTimeout((function(){a.createCanvas(s,e,t)}),i))):this.createCanvas(s,e,t),s},_clearDelaysForZoom:function(){var e=this._delaysForZoom,t=this._delays[e];t&&(t.forEach((function(e,a){clearTimeout(e),delete t[a]})),delete this._delays[e])}}),L.tileLayer.canvas=function(e,t){return new L.TileLayer.Canvas(e,t)};